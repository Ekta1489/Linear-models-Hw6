---
title: "p8105_Hw6_Ec3342"
author: "Ekta Chaudhary"
date: "14/11/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```
#Reading the data set and tidying the data. Converted the numeric to factor variables. Removed pnumlbw, pnumsga, malform as these variables had a value of 0 for all the observations.So, there was no point keeping these variables in the dataset.

```{r}
baby_data = read_csv(file = "./data/birthweight.csv") %>%
  janitor::clean_names() %>%
  mutate(
    babysex = as.factor(babysex),
    frace = as.factor(frace),
    malform = as.factor(malform),
    mrace = as.factor(mrace)
  ) %>%
  select(-pnumlbw, -pnumsga, -malform)
```

#Checking if there are any missing variables. After running the code, we see that there are no missing variables; Therefore, we do not have to do anything more to clean the data.

```{r}
filter_all(
  baby_data, any_vars(is.na(.))
)
```
#Propose a regression model for birthweight. As the outcome is continuous, we can fit a linear regression model. 


```{r}

reg_mod = lm(bwt ~ gaweeks + babysex + momage + mrace  + wtgain + smoken, data = baby_data)
reg_mod %>% 
  broom::tidy() 

```
```{r}
baby_data %>% 
  modelr::add_predictions(reg_mod) %>% 
  modelr::add_residuals(reg_mod) %>% 
  ggplot(aes(x = pred, y = resid)) + geom_point() +
  labs(x = "Predicted value", 
       y = "Residual")
```

